
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>復習管理（Web/PWA）</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>復習管理（Web/PWA）</h1>
    <div class="row">
      <label>教科：</label>
      <select id="subjectSelect"></select>
      <button id="addSubjectBtn">教科追加</button>
      <button id="subjectUpBtn">↑</button>
      <button id="subjectDownBtn">↓</button>

      <div class="spacer"></div>

      <button id="exportBtn">エクスポート(JSON)</button>
      <label class="filebtn">
        インポート(JSON)
        <input id="importFile" type="file" accept="application/json" />
      </label>
      <button id="wipeBtn" class="danger">この端末のデータ全消去</button>
    </div>
    <p class="hint">
      ※データは端末内に保存（PCとAndroidは別々）。同期はエクスポート→共有→インポートで手動です。
    </p>
  </header>

  <main>
    <section class="card">
      <h2>今日学習した単元</h2>
      <p class="hint">例： <code>1-1:課税標準, 7-14:納税義務者</code>（スペース/改行/「、」もOK）</p>
      <textarea id="todayInput" rows="3" placeholder="1-1:課税標準, 7-14:納税義務者"></textarea>
      <label><input type="checkbox" id="overwriteTitle" /> タイトル上書き</label>
      <div class="row">
        <button id="recordTodayBtn">記録する</button>
        <div id="log" class="log"></div>
      </div>
    </section>

    <section class="grid2">
      <section class="card">
        <h2>今日やるべき（期限切れ含む）</h2>
        <table class="tbl" id="dueTable">
          <thead>
            <tr>
              <th>教科</th><th>単元</th><th>タイトル</th><th>前回回数</th><th>前回日</th><th>次回予定</th><th>遅延(日)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <section class="card">
        <h2>今後7日間の予定（グルーピング）</h2>
        <table class="tbl" id="upcomingTable">
          <thead>
            <tr>
              <th>予定日</th><th>教科</th><th>単元</th><th>タイトル</th><th>前回回数</th><th>前回日</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </section>

    <section class="card">
      <h2>単元管理</h2>
      <div class="grid2">
        <div>
          <h3>単元一覧</h3>
          <table class="tbl" id="unitsTable">
            <thead>
              <tr>
                <th>単元</th><th>タイトル</th><th>最終回数</th><th>最終日</th><th>次回予定</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div>
          <h3>単元の追加/記録（記録忘れリカバリ）</h3>
          <div class="form">
            <label>単元コード <input id="unitCode" placeholder="7-14" /></label>
            <label>タイトル <input id="unitTitle" placeholder="納税義務者" /></label>
            <label>学習日 <input id="unitDate" type="date" /></label>
            <label>回数（任意） <input id="unitReviewNo" type="number" min="1" step="1" placeholder="空欄なら自動" /></label>
            <label><input type="checkbox" id="overwriteTitle2" /> タイトル上書き</label>
            <div class="row">
              <button id="addOrRecordBtn">追加/記録</button>
              <button id="deleteUnitBtn" class="danger">この単元を削除</button>
            </div>
          </div>

          <h3 style="margin-top:14px;">復習履歴（編集/削除/再採番）</h3>
          <table class="tbl" id="reviewsTable">
            <thead>
              <tr><th>ID</th><th>回数</th><th>学習日</th></tr>
            </thead>
            <tbody></tbody>
          </table>

          <div class="form">
            <p class="hint">選択した履歴を編集：</p>
            <label>回数 <input id="editReviewNo" type="number" min="1" step="1" /></label>
            <label>学習日 <input id="editReviewDate" type="date" /></label>
            <div class="row">
              <button id="updateReviewBtn">更新（編集）</button>
              <button id="deleteReviewBtn" class="danger">選択した履歴を削除</button>
              <button id="renumberBtn">再採番（日付順に1..n）</button>
            </div>
            <p class="hint">※IndexedDBは端末内保存なので、同期はJSONで手動。IndexedDBは同一オリジンで使う仕組み。 [5](https://play.google.com/store/apps/details?id=com.pixclown.boukyaku&hl=ja)[6](https://tanzam.net/column/ebbinghaus-forgetting-curve/)</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <small>Web/PWA版（GitHub Pagesで配信）</small>
  </footer>

  <script src="db.js"></script>
  <script src="app.js"></script>
</body>
</html>
